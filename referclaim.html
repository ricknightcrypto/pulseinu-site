---
layout: default
---

<div class="header">
    Referrer & Early Adopter Claims <br>
</div>

<div class="claims">
    <button onclick="claimReferrer()" id="claimReferrer" class="connect-btn-lg">Referrer Claim</button>
    <button onclick="claimEarly()" id="earlyAdopter" class="connect-btn-lg" style="width: 270px;">Early Adopter Claim</button>
</div>

<script>

    const claimReferrer = async () => {
        if (!isInitialized) {
            await init();
        }

        let callingAccount = window.ethereum._state.accounts[0]
        if (callingAccount === undefined || getParameterCaseInsensitive(dict, callingAccount) == undefined) {
           return;
        }

        // Get Percent
        const percent = getParameterCaseInsensitive(dict, callingAccount)

        const addresses = Object.keys(dict)

        let leafNodes = []

        for (let i = 0; i < addresses.length; i++) {
            leafNodes.push(keccak256(addresses[i] + dict[addresses[i]]))
        }

        // Create tree
        let merkleTree = new MerkleTree(leafNodes, keccak256, { sortPairs: true })

        // Get Proof
        let hashedAddress = keccak256(callingAccount + percent)

        let proof = merkleTree.getHexProof(hashedAddress)

        pulseInuContract.methods
            .claimReferrer(proof, parseInt("0x" + percent, 16))
            .send(
                {
                    from: callingAccount,
                }
            ).then((res) => {
                console.log(res);
                openModal('Claimed to your account successfully!', true);
            }).catch((err) => {
                openModal(err.message, false);
            });
    }

     const claimEarly = async () => {
         if (!isInitialized) {
             await init();
         }

         let addresses = ADOPTERS // early adopter addresses

         // Hash leaves
         // This could be done on page load - update
         let leaves = addresses.map(addr => keccak256(addr))

         // Create tree
         let merkleTree = new MerkleTree(leaves, keccak256, { sortPairs: true })
         let rootHash = merkleTree.getRoot().toString('hex')

    //     // 'Serverside' code
         const callingAccount = window.ethereum._state.accounts[0]
         let hashedAddress = keccak256(callingAccount)
         let proof = merkleTree.getHexProof(hashedAddress)

         pulseInuContract.methods
            .claimFirstAdopter(proof)
            .send(
                {
                    from: callingAccount,
                }
            ).then((res) => {
                console.log(res);
                openModal('Claimed to your account successfully!', true);
            }).catch((err) => {
                openModal(err.message, false);
            });
     }
</script>
